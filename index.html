<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>MyShop LIFF</title>
  <script src="https://static.line-scdn.net/liff/edge/versions/2.21.0/sdk.js"></script>

  <style>
    body { font-family: sans-serif; padding: 20px; }
    .product { border: 1px solid #ccc; padding: 15px; margin-bottom: 10px; }
    button { padding: 5px 15px; }
  </style>
</head>

<body>

<h2>歡迎光臨 MyShop！</h2>
<p>用戶：<span id="username">載入中...</span></p>

<h3>商品列表</h3>
<div id="product-list"></div>

<button onclick="checkout()">結帳</button>

<script>
const LIFF_ID = "2008573741-WGE2G7lZ";   // ← 一定要換成你的 LIFF ID
let USER = null;
let CART = [];

// 測試三個商品
const products = [
  { id: 1, name: "紅茶", price: 30 },
  { id: 2, name: "奶茶", price: 45 },
  { id: 3, name: "綠茶", price: 25 }
];

async function main() {
  await liff.init({ liffId: LIFF_ID });

  if (!liff.isLoggedIn()) {
    liff.login();
    return;
  }

  const profile = await liff.getProfile();
  USER = {
    userId: profile.userId,
    name: profile.displayName
  };

  document.getElementById("username").innerText = USER.name;

  // 顯示商品
  const list = document.getElementById("product-list");
  products.forEach(p => {
    const div = document.createElement("div");
    div.className = "product";
    div.innerHTML = `
      <b>${p.name}</b><br>
      價格：${p.price} 元<br>
      <button onclick="addToCart(${p.id})">加入購物車</button>
    `;
    list.appendChild(div);
  });
}

function addToCart(id) {
  const item = products.find(p => p.id === id);
  CART.push(item);
  alert("已加入：" + item.name);
}

function checkout() {
  if (CART.length === 0) return alert("購物車是空的！");

  fetch("你的 GAS Webhook URL", {
    method: "POST",
    body: JSON.stringify({
      userId: USER.userId,
      name: USER.name,
      cart: CART,
      total: CART.reduce((s, p) => s + p.price, 0)
    })
  })
  .then(() => {
    alert("訂單完成！");
  });
}

main();
</script>

</body>
</html>


